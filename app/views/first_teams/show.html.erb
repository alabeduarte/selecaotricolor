<% content_for :title, "#{@formation.match}" %>
<%= render :partial => "calendars/match_info", :locals => { :match => @formation.match } %>
<input id="host" type="hidden" value=<%= "#{request.host}" %> />
<div class="first-team">
	<div class="rating call-up">
		<table id="squad_of_the_round">
			<%= render :partial => "rating/squad_of_the_round", :locals => { :first_team => @first_team } %>
		</table>
	</div>			
	<div id="soccerField" class="soccer-field-grass show-first-team">
		<div id="emptySlot"></div>
	</div>
	<div id="creator-info" class="show formation">
		<ul>			
			<li><%= image_tag(@formation.owner.image, :size => "45x45", :class => "user-avatar") %></li>
			<li><%= "#{t(:sent_by)} #{@formation.owner.nickname}" %></li>
			<li><%= "#{t(:created_at)} #{@formation.created_at.to_s(:day)}" %></li>
			<li class="share"><%= render :partial => "rating/share" %></li>
			<li>
				<div class="pills actions">
					<%= link_to "TÃ¡ticas enviadas", {:controller => 'calendars', :action => 'formations_matches', :id => @formation.match}, :class => 'icon formations' %>
				</di>
			</li>
		</ul>     		
	</div>	
</div>
<%= content_for :javascript do %>
	$( load_soccer_field );
	$( load_formation );
	
	FB.Event.subscribe('edge.create', function(response) {
		var uri = response.replace($('#host').val(), "");
		var validTarget = response.indexOf("positions/rating") > 0 || response.indexOf("substitutions/rating") > 0;
		if (validTarget) {
			$.ajax({
		  			url:   uri,
					type:  "POST"
			});
		}
	});
	
	FB.Event.subscribe('edge.remove', function(response) {
		var uri = response.replace($('#host').val(), "");
		var validTarget = response.indexOf("positions/rating") > 0 || response.indexOf("substitutions/rating") > 0;
		if (validTarget) {
			$.ajax({
		  			url:   uri,
					type:  "DELETE"
			});
		}		
	});	
<% end %>