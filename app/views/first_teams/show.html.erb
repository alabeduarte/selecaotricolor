<% content_for :title, "#{@formation.match}" %>
<%= render :partial => "calendars/match_info", :locals => { :match => @formation.match } %>
<input id="host" type="hidden" value=<%= "#{request.host}" %> />
<div class="formation-header large">
	<h2 class="tactical"><%= "#{@formation.tactical}" %></h2>			
</div>
<div class="rating call-up">
	<table id="squad_of_the_round">
		<% @formation.players_ordered_by_positions.each do |position| %>	  	
			<% if @first_team.has_replaced?(position.player) %>
				<tr>
					<td class="position"><-</td>
				    <td><%= position.player.name %></td>
					<td>
						<fb:like show_faces="no" layout="button_count" href=<%= "#{request.host}/positions/rating/#{position.id}" %>></fb:like>
					</td>
				</tr>
				<tr>
					<td class="position">-></td>
				    <td><%= @first_team.alternate_of(position.player).name %></td>
					<td>
						<fb:like show_faces="no" layout="button_count" href=<%= "#{request.host}/positions/rating/#{position.id}" %>></fb:like>
					</td>
				</tr>
			<% else %>
				<tr>
					<td class="position"><%= position.acronym %></td>
				    <td><%= position.player.name %></td>
					<td>
						<fb:like show_faces="no" layout="button_count" href=<%= "#{request.host}/positions/rating/#{position.id}" %>></fb:like>
					</td>
				</tr>
			<% end %>
		<% end %>
	</table>
</div>			
<div id="soccerField" class="soccer-field-grass show-formation">
	<div id="emptySlot"></div>
</div>
<div id="creator-info" class="show formation">
	<ul>
		<li>
			<div class="link">
				Para ver todas as t√°ticas deste jogo, <%= link_to "clique aqui!", :controller => 'calendars', :action => 'formations_matches', :id => @formation.match %>
			</div>
		</li>
		<li><%= image_tag(@formation.owner.image, :size => "45x45", :class => "user-avatar") %></li>
		<li><%= "#{t(:sent_by)} #{@formation.owner.nickname}" %></li>
		<li><%= "#{t(:created_at)} #{@formation.created_at.to_s(:day)}" %></li>
		<li class="share"><%= render :partial => "rating/share" %></li>
	</ul>     		
</div>

<%= content_for :footer_resources do %>
<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
<% end %>

<%= content_for :javascript do %>
	$( load_soccer_field );
	$( load_formation );
	
	FB.Event.subscribe('edge.create', function(response) {
		var uri = response.replace($('#host').val(), "");
		if (response.indexOf("positions/rating") > 0) {
			$.ajax({
		  			url:   uri,
					type:  "POST"
			});
		}		
	});
	
	FB.Event.subscribe('edge.remove', function(response) {
		var uri = response.replace($('#host').val(), "");
		if (response.indexOf("positions/rating") > 0) {
			$.ajax({
		  			url:   uri,
					type:  "DELETE"
			});
		}		
	});	
<% end %>